import"../chunks/DsnmJJEf.js";import{i as Ct}from"../chunks/CHiPrc7u.js";import{o as Vt,e as X,s as L}from"../chunks/UnYEAh3D.js";import{e as lt,b as yt,s as Me,h as $,a2 as wt,a as Pt,y as a,ar as Et,r as Mt,H as Tt,c as at,d as Te,k as de,a3 as St,a7 as Nt,f as Re,i as kt,g as oe,as as zt,at as B,au as st,ab as it,_ as It,av as Bt,j as ot,p as Dt,aw as Ot,ax as $t,ay as Se,az as vt,a5 as Rt,aA as Ht,aa as Ft,aB as qt,a0 as Lt,aC as Gt,aq as Yt,v as Jt,aD as Kt,aE as Ut,C as Wt,D as F,G as ne,I as O,J as Xt,O as _,K as m,M as c,aF as pe,aG as b,aH as Ne,aI as Qt,F as ke,P as Zt}from"../chunks/CFlVANVU.js";import{i as he}from"../chunks/CmHAaHou.js";import{r as ze}from"../chunks/ejW4-gH6.js";function le(e,n){return n}function ea(e,n,t){for(var s=e.items,r=[],i=n.length,o=0;o<i;o++)Ht(n[o].e,r,!0);var f=i>0&&r.length===0&&t!==null;if(f){var x=t.parentNode;Ft(x),x.append(t),s.clear(),G(e,n[0].prev,n[i-1].next)}qt(r,()=>{for(var u=0;u<i;u++){var A=n[u];f||(s.delete(A.k),G(e,A.prev,A.next)),vt(A.e,!f)}})}function ie(e,n,t,s,r,i=null){var o=e,f={flags:n,items:new Map,first:null};{var x=e;o=$?Me(wt(x)):x.appendChild(lt())}$&&Pt();var u=null,A=!1,M=new Map,v=Et(()=>{var l=t();return It(l)?l:l==null?[]:it(l)}),V,d;function w(){ta(d,V,f,M,o,r,n,s,t),i!==null&&(V.length===0?u?ot(u):u=Re(()=>i(o)):u!==null&&Dt(u,()=>{u=null}))}yt(()=>{d??=Lt,V=a(v);var l=V.length;if(A&&l===0)return;A=l===0;let j=!1;if($){var P=Mt(o)===Tt;P!==(l===0)&&(o=at(),Me(o),Te(!1),j=!0)}if($){for(var C=null,g,p=0;p<l;p++){if(de.nodeType===St&&de.data===Nt){o=de,j=!0,Te(!1);break}var T=V[p],z=s(T,p);g=He(de,f,C,null,T,z,p,r,n,t),f.items.set(z,g),C=g}l>0&&Me(at())}if($)l===0&&i&&(u=Re(()=>i(o)));else if(kt()){var Y=new Set,N=oe;for(p=0;p<l;p+=1){T=V[p],z=s(T,p);var J=f.items.get(z)??M.get(z);J?ft(J,T,p):(g=He(null,f,null,null,T,z,p,r,n,t,!0),M.set(z,g)),Y.add(z)}for(const[K,U]of f.items)Y.has(K)||N.skipped_effects.add(U.e);N.add_callback(w)}else w();j&&Te(!0),a(v)}),$&&(o=de)}function ta(e,n,t,s,r,i,o,f,x){var u=n.length,A=t.items,M=t.first,v=M,V,d=null,w=[],l=[],j,P,C,g;for(g=0;g<u;g+=1){if(j=n[g],P=f(j,g),C=A.get(P),C===void 0){var p=s.get(P);if(p!==void 0){s.delete(P),A.set(P,p);var T=d?d.next:v;G(t,d,p),G(t,p,T),Ie(p,T,r),d=p}else{var z=v?v.e.nodes_start:r;d=He(z,t,d,d===null?t.first:d.next,j,P,g,i,o,x)}A.set(P,d),w=[],l=[],v=d.next;continue}if(ft(C,j,g),(C.e.f&Se)!==0&&ot(C.e),C!==v){if(V!==void 0&&V.has(C)){if(w.length<l.length){var Y=l[0],N;d=Y.prev;var J=w[0],K=w[w.length-1];for(N=0;N<w.length;N+=1)Ie(w[N],Y,r);for(N=0;N<l.length;N+=1)V.delete(l[N]);G(t,J.prev,K.next),G(t,d,J),G(t,K,Y),v=Y,d=K,g-=1,w=[],l=[]}else V.delete(C),Ie(C,v,r),G(t,C.prev,C.next),G(t,C,d===null?t.first:d.next),G(t,d,C),d=C;continue}for(w=[],l=[];v!==null&&v.k!==P;)(v.e.f&Se)===0&&(V??=new Set).add(v),l.push(v),v=v.next;if(v===null)continue;C=v}w.push(C),d=C,v=C.next}if(v!==null||V!==void 0){for(var U=V===void 0?[]:it(V);v!==null;)(v.e.f&Se)===0&&U.push(v),v=v.next;var ve=U.length;if(ve>0){var ue=u===0?r:null;ea(t,U,ue)}}e.first=t.first&&t.first.e,e.last=d&&d.e;for(var fe of s.values())vt(fe.e);s.clear()}function ft(e,n,t,s){zt(e.v,n),e.i=t}function He(e,n,t,s,r,i,o,f,x,u,A){var M=(x&Ot)!==0,v=(x&$t)===0,V=M?v?B(r,!1,!1):st(r):r,d=(x&Bt)===0?o:st(o),w={i:d,v:V,k:i,a:null,e:null,prev:t,next:s};try{if(e===null){var l=document.createDocumentFragment();l.append(e=lt())}return w.e=Re(()=>f(e,V,d,u),$),w.e.prev=t&&t.e,w.e.next=s&&s.e,t===null?A||(n.first=w):(t.next=w,t.e.next=w.e),s!==null&&(s.prev=w,s.e.prev=w.e),w}finally{}}function Ie(e,n,t){for(var s=e.next?e.next.e.nodes_start:t,r=n?n.e.nodes_start:t,i=e.e.nodes_start;i!==null&&i!==s;){var o=Rt(i);r.before(i),i=o}}function G(e,n,t){n===null?e.first=t:(n.next=t,n.e.next=t&&t.e),t!==null&&(t.prev=n,t.e.prev=n&&n.e)}const rt=[...` 	
\r\f \v\uFEFF`];function aa(e,n,t){var s=e==null?"":""+e;if(n&&(s=s?s+" "+n:n),t){for(var r in t)if(t[r])s=s?s+" "+r:r;else if(s.length)for(var i=r.length,o=0;(o=s.indexOf(r,o))>=0;){var f=o+i;(o===0||rt.includes(s[o-1]))&&(f===s.length||rt.includes(s[f]))?s=(o===0?"":s.substring(0,o))+s.substring(f+1):o=f}}return s===""?null:s}function sa(e,n){return e==null?null:String(e)}function me(e,n,t,s,r,i){var o=e.__className;if($||o!==t||o===void 0){var f=aa(t,s,i);(!$||f!==e.getAttribute("class"))&&(f==null?e.removeAttribute("class"):e.className=f),e.__className=t}else if(i&&r!==i)for(var x in i){var u=!!i[x];(r==null||u!==!!r[x])&&e.classList.toggle(x,u)}return i}function ra(e,n,t,s){var r=e.__style;if($||r!==n){var i=sa(n);(!$||i!==e.getAttribute("style"))&&(i==null?e.removeAttribute("style"):e.style.cssText=i),e.__style=n}return s}function Be(e,n,t=n){var s=new WeakSet;Gt(e,"input",async r=>{var i=r?e.defaultValue:e.value;if(i=De(e)?Oe(i):i,t(i),oe!==null&&s.add(oe),await Yt(),i!==(i=n())){var o=e.selectionStart,f=e.selectionEnd;e.value=i??"",f!==null&&(e.selectionStart=o,e.selectionEnd=Math.min(f,e.value.length))}}),($&&e.defaultValue!==e.value||Jt(n)==null&&e.value)&&(t(De(e)?Oe(e.value):e.value),oe!==null&&s.add(oe)),Kt(()=>{var r=n();if(e===document.activeElement){var i=Ut??oe;if(s.has(i))return}De(e)&&r===Oe(e.value)||e.type==="date"&&!r&&!e.value||r!==e.value&&(e.value=r??"")})}function De(e){var n=e.type;return n==="number"||n==="range"}function Oe(e){return e===""?null:+e}function $e(e,n){if(!e)throw new Error(n||"Assertion failed")}function na(e,n){const t=n.length,s=e[0]?.length||0;if(t===0||s===0)return[];const r=new Map;n.forEach((l,j)=>r.set(l,j));const i=[];for(let l=0;l<s;l++){const j=[];for(let P=0;P<t;P++){const C=e[P][l],g=r.get(C)??-1;if(g===-1)return[];j.push(g)}i.push(j)}const o=t-1,f=(l,j)=>j===0?l:f(j,l%j),x=f(o,s),u=o/x,A=s/x,M=u;let v=[];for(let l=0;l<t;l++)for(let j=0;j<A;j++)v.push(l);let V=new Map;for(let l=0;l<t;l++)V.set(l,A);for(let l=0;l<s;l++){$e(v.length>1,"Should have multiple alternatives remaining at start of round");const j=i[l],P=[];for(const g of j){const p=V.get(g)||0;for(let T=0;T<p;T++)P.push(g)}P.slice(-M).forEach(g=>{const p=v.indexOf(g);$e(p>-1),v.splice(p,1);const T=V.get(g)||0;T>1?V.set(g,T-1):V.delete(g)})}$e(v.length>0,`PVC should be empty. remainingAlts is ${v}`);const d=new Set(v);return Array.from(d).map(l=>n[l])}function la(e,n,t,s){if(n.length===0)return{canVeto:!1,preferredAlternatives:[]};const r=[],i=new Map;s.forEach((l,j)=>i.set(l,j));const o=s.length;for(const l of n){const j=[];for(let P=0;P<o;P++){const C=t[P][l],g=i.get(C)??-1;if(g===-1)return{canVeto:!1,preferredAlternatives:[]};j.push(g)}r.push(j)}const f=i.get(e);if(f===void 0)return{canVeto:!1,preferredAlternatives:[]};const x=new Set,u=r[0],A=u.indexOf(f);if(A===-1)return{canVeto:!1,preferredAlternatives:[]};for(let l=0;l<A;l++)x.add(u[l]);for(let l=1;l<r.length;l++){const j=r[l],P=j.indexOf(f);if(P===-1)return{canVeto:!1,preferredAlternatives:[]};const C=new Set;for(let p=0;p<P;p++)C.add(j[p]);const g=new Set;for(const p of x)C.has(p)&&g.add(p);x.clear(),g.forEach(p=>x.add(p))}const M=t[0]?.length||0,v=n.length,V=x.size,d=1-v/M<=V/o,w=Array.from(x).map(l=>s[l]);return{canVeto:d,preferredAlternatives:w}}function nt(e,n,t,s){const r=t.length,i=n[0]?.length||0;let o=[],f=[];for(let u=1;u<1<<i;u++){const A=[];for(let v=0;v<i;v++)u&1<<v&&A.push(v);const M=la(e,A,n,t);M.canVeto&&o.length===0&&(o=A,f=M.preferredAlternatives)}const x={T:o.length,T_size:o.length,v_T:o.length/i,B:f,lambda_B_over_P:f.length/r};return{coalition:o,selectedAlternative:e,preferredAlternatives:f,dashboardValues:x}}function ia(e,n){return e.length!==n.length||new Set(e).size!==e.length||e.some(s=>!s)?!1:e.every(s=>n.includes(s))}function oa(e){return Array.from({length:e},(n,t)=>String.fromCharCode(97+t))}var va=F('<input type="text" maxlength="1"/>'),fa=F('<div class="matrix-row svelte-1x0fajo"></div>'),ca=F('<div role="button" tabindex="0"> </div>'),da=F('<section class="section svelte-1x0fajo"><div class="column-header svelte-1x0fajo"><h3>PVC</h3> <p class="instruction svelte-1x0fajo">Click on any alternative below to see a veto coalition</p></div> <div class="pvc-list-horizontal svelte-1x0fajo"></div> <div class="legend svelte-1x0fajo"><span class="legend-item svelte-1x0fajo"><span class="border-box successive-border svelte-1x0fajo"></span> Successive Elimination Result</span> <span class="legend-item svelte-1x0fajo"><span class="color-box green svelte-1x0fajo"></span> In PVC</span> <span class="legend-item svelte-1x0fajo"><span class="color-box yellow svelte-1x0fajo"></span> Not in PVC</span></div></section>'),ua=F("<div> </div>"),_a=F('<div class="veto-matrix-row svelte-1x0fajo"></div>'),pa=F('<div class="coalition-arrow svelte-1x0fajo"><div class="arrow-pointer svelte-1x0fajo">↑</div> <div class="arrow-label svelte-1x0fajo"></div></div>'),ha=F('<div class="analysis-section found svelte-1x0fajo"><h4 class="svelte-1x0fajo">Veto Coalition Found</h4> <div class="coalition-info svelte-1x0fajo"><p class="svelte-1x0fajo"><strong>Coalition Members (T):</strong> </p> <p class="svelte-1x0fajo"><strong>Preferred Alternatives (B):</strong> </p> <p class="svelte-1x0fajo"><strong>Relative size of preferred alternatives (|B|/m):</strong> </p></div></div> <div class="veto-matrix-section svelte-1x0fajo"><h4 class="svelte-1x0fajo">Veto Coalition Preference Matrix</h4> <div class="veto-matrix-container svelte-1x0fajo"><div class="veto-matrix svelte-1x0fajo"></div> <div class="coalition-arrows svelte-1x0fajo"></div></div> <div class="veto-matrix-legend svelte-1x0fajo"><span class="legend-item svelte-1x0fajo"><span class="coalition-arrow-legend svelte-1x0fajo">↑</span> Coalition Members</span> <span class="legend-item svelte-1x0fajo"><span class="color-box selected-alt-legend svelte-1x0fajo"></span> Vetoed Alternative</span> <span class="legend-item svelte-1x0fajo"><span class="color-box preferred-alt-legend svelte-1x0fajo"></span> Preferred Alternatives</span></div></div> <div class="metrics-section svelte-1x0fajo"><div class="metrics-grid svelte-1x0fajo"><div class="metric-item svelte-1x0fajo"><div class="metric-symbol svelte-1x0fajo">|T|/n</div> <div class="metric-details svelte-1x0fajo"><div class="metric-label svelte-1x0fajo">Voting Power</div> <div class="metric-value svelte-1x0fajo"> </div></div></div> <div class="metric-item svelte-1x0fajo"><div class="metric-symbol svelte-1x0fajo">1-|B|/m</div> <div class="metric-details svelte-1x0fajo"><div class="metric-label svelte-1x0fajo">Veto size</div> <div class="metric-value svelte-1x0fajo"> </div></div></div></div></div> <p class="veto-explanation svelte-1x0fajo">An alternative is vetoed if the voting power of the coalition can afford the veto size: <strong>|T|/n ≥ 1 - |B|/m</strong></p> <div class="condition-result svelte-1x0fajo"><div><span class="condition-text svelte-1x0fajo"> </span> <span class="condition-status svelte-1x0fajo"> </span></div></div> <button class="clear-btn svelte-1x0fajo">Clear Analysis</button>',1),ma=F(`<div class="analysis-section not-found svelte-1x0fajo"><h4 class="svelte-1x0fajo">No Veto Coalition Found</h4> <p>No coalition of voters can veto alternative <strong> </strong></p> <p class="no-veto-explanation svelte-1x0fajo">This alternative cannot be eliminated through the proportional veto mechanism with the
							current preference profile.</p></div> <button class="clear-btn svelte-1x0fajo">Clear Analysis</button>`,1),xa=F('<section class="section svelte-1x0fajo"><div class="veto-dashboard svelte-1x0fajo"><!></div></section>'),ga=F('<main class="container svelte-1x0fajo"><h1>Proportional Veto Core Playground</h1> <section class="section svelte-1x0fajo"><h2>Parameters</h2> <div class="inputs svelte-1x0fajo"><label class="svelte-1x0fajo">m (alternatives): <input type="number" min="1" max="26" class="svelte-1x0fajo"/></label> <label class="svelte-1x0fajo">n (voters): <input type="number" min="1" class="svelte-1x0fajo"/></label></div> <div class="subsection svelte-1x0fajo"><h3>Initialize Matrix</h3> <button class="svelte-1x0fajo">Identical Preferences</button> <button class="svelte-1x0fajo">Randomize</button></div></section> <section class="section svelte-1x0fajo"><div class="column-header svelte-1x0fajo"><h3>Voter Preference</h3> <p>Click on any cell to edit the alternative.</p></div> <div class="matrix svelte-1x0fajo"></div> <button class="compute-btn svelte-1x0fajo">Compute PVC</button></section> <!> <!> <footer class="contact-footer svelte-1x0fajo"><p class="svelte-1x0fajo">Contact: jeqin_chooi@college.harvard.edu</p></footer></main>');function wa(e,n){Wt(n,!1);let t=B(3),s=B(3),r=B([]),i=B([]),o=B(""),f=B([]),x=B([]),u=B(0),A=B(0),M=B(!1),v=B(!1);function V(){b(r,Array(a(t)).fill(null).map(()=>Array(a(s)).fill("")))}function d(){return oa(a(t))}function w(){const h=d();b(r,h.map(()=>Array(a(s)).fill("")));for(let y=0;y<a(s);y++)for(let E=0;E<a(t);E++)Ne(r,a(r)[E][y]=h[E]);b(r,[...a(r)]),b(M,!1),b(v,!1)}function l(){const h=d();b(r,h.map(()=>Array(a(s)).fill("")));for(let y=0;y<a(s);y++){const E=[...h].sort(()=>Math.random()-.5);for(let S=0;S<a(t);S++)Ne(r,a(r)[S][y]=E[S])}b(r,[...a(r)]),b(M,!1),b(v,!1)}function j(h){const y=a(r).map(S=>S[h]),E=d();return ia(y,E)}function P(){for(let h=0;h<a(s);h++)if(!j(h))return!1;return!0}function C(){const h=d(),y=[];for(const S of h)nt(S,a(r),h).preferredAlternatives.length>0||y.push(S);b(i,y);const E=na(a(r),h);b(g,E),b(M,!0),b(v,!1)}let g=B([]);function p(h){const y=d(),E=nt(h,a(r),y,a(i));b(o,E.selectedAlternative),b(f,E.coalition),b(x,E.preferredAlternatives),b(u,E.dashboardValues.v_T),b(A,E.dashboardValues.lambda_B_over_P),b(v,!0)}function T(){b(o,""),b(f,[]),b(x,[]),b(u,0),b(A,0)}function z(){V(),b(i,[]),b(o,""),b(f,[]),b(x,[]),b(M,!1),b(v,!1)}function Y(h,y,E){Ne(r,a(r)[h][y]=E.toLowerCase()),b(r,[...a(r)])}Vt(()=>{V()}),Ct();var N=ga(),J=_(m(N),2),K=_(m(J),2),U=m(K),ve=_(m(U));ze(ve),c(U);var ue=_(U,2),fe=_(m(ue));ze(fe),c(ue),c(K);var Fe=_(K,2),qe=_(m(Fe),2),ct=_(qe,2);c(Fe),c(J);var xe=_(J,2),ge=_(m(xe),2);ie(ge,5,()=>a(r),le,(h,y,E)=>{var S=fa();ie(S,5,()=>a(y),le,(R,Q,k)=>{var I=va();ze(I);let D;ne(H=>D=me(I,1,"matrix-cell svelte-1x0fajo",null,D,H),[()=>({invalid:!j(k)})]),Be(I,()=>a(y)[k],H=>(a(y)[k]=H,Qt(()=>(a(y),a(r))))),X("input",I,H=>Y(E,k,H.target.value)),O(R,I)}),c(S),O(h,S)}),c(ge);var Le=_(ge,2);c(xe);var Ge=_(xe,2);{var dt=h=>{var y=da(),E=_(m(y),2);ie(E,5,d,le,(S,R)=>{var Q=ca();let k;var I=m(Q,!0);c(Q),ne(D=>{k=me(Q,1,"pvc-item svelte-1x0fajo",null,k,D),L(I,a(R))},[()=>({"in-pvc":a(i).includes(a(R)),"not-in-pvc":!a(i).includes(a(R)),highlighted:a(f).length>0&&a(o)===a(R),"successive-elimination":a(g).includes(a(R))})]),X("click",Q,()=>p(a(R))),O(S,Q)}),c(E),pe(2),c(y),O(h,y)};he(Ge,h=>{a(M)&&h(dt)})}var ut=_(Ge,2);{var _t=h=>{var y=xa(),E=m(y),S=m(E);{var R=k=>{var I=ha(),D=ke(I),H=_(m(D),2),se=m(H),je=_(m(se));c(se);var ce=_(se,2),pt=_(m(ce));c(ce);var Ye=_(ce,2),ht=_(m(Ye));c(Ye),c(H),c(D);var be=_(D,2),Je=_(m(be),2),Ae=m(Je);ie(Ae,5,()=>a(r),le,(ee,_e)=>{var W=_a();ie(W,5,()=>a(_e),le,(re,Z,te)=>{var q=ua();let ae;var Ee=m(q,!0);c(q),ne(At=>{ae=me(q,1,"veto-matrix-cell svelte-1x0fajo",null,ae,At),L(Ee,a(Z))},[()=>({"veto-column":a(f).includes(te),"selected-alternative":a(f).includes(te)&&a(Z)===a(o),"preferred-alternative":a(f).includes(te)&&a(x).includes(a(Z))&&a(Z)!==a(o)})]),O(re,q)}),c(W),O(ee,W)}),c(Ae);var Ke=_(Ae,2);ie(Ke,5,()=>Array(a(s)),le,(ee,_e,W)=>{var re=Zt(),Z=ke(re);{var te=q=>{var ae=pa();ra(ae,`left: ${W*42+21}px;`);var Ee=_(m(ae),2);Ee.textContent=`Voter ${W+1}`,c(ae),O(q,ae)};he(Z,q=>{a(f).includes(W)&&q(te)})}O(ee,re)}),c(Ke),c(Je),pe(2),c(be);var Ce=_(be,2),Ue=m(Ce),Ve=m(Ue),We=_(m(Ve),2),Xe=_(m(We),2),mt=m(Xe,!0);c(Xe),c(We),c(Ve);var Qe=_(Ve,2),Ze=_(m(Qe),2),et=_(m(Ze),2),xt=m(et,!0);c(et),c(Ze),c(Qe),c(Ue),c(Ce);var ye=_(Ce,4),we=m(ye),Pe=m(we),gt=m(Pe);c(Pe);var tt=_(Pe,2),jt=m(tt,!0);c(tt),c(we),c(ye);var bt=_(ye,2);ne((ee,_e,W,re,Z,te,q)=>{L(je,` Voters ${ee??""}`),L(pt,` [${_e??""}]`),L(ht,` ${W??""}`),L(mt,re),L(xt,Z),me(we,1,`condition-check ${a(u)>=1-a(A)?"satisfied":"not-satisfied"}`,"svelte-1x0fajo"),L(gt,`${te??""}
								${a(u)>=1-a(A)?"≥":"<"}
								${q??""}`),L(jt,a(u)>=1-a(A)?"✓ Condition Satisfied":"✗ Condition Not Satisfied")},[()=>a(f).map(ee=>ee+1).join(", "),()=>a(x).join(", "),()=>Math.round(a(A)*1e3)/1e3,()=>Math.round(a(u)*1e3)/1e3,()=>Math.round((1-a(A))*1e3)/1e3,()=>Math.round(a(u)*1e3)/1e3,()=>Math.round((1-a(A))*1e3)/1e3]),X("click",bt,T),O(k,I)},Q=k=>{var I=ma(),D=ke(I),H=_(m(D),2),se=_(m(H)),je=m(se,!0);c(se),c(H),pe(2),c(D);var ce=_(D,2);ne(()=>L(je,a(o))),X("click",ce,T),O(k,I)};he(S,k=>{a(x).length>0?k(R):k(Q,!1)})}c(E),c(y),O(h,y)};he(ut,h=>{a(v)&&a(o)&&h(_t)})}pe(2),c(N),ne(h=>Le.disabled=h,[()=>!P()]),Be(ve,()=>a(t),h=>b(t,h)),X("change",ve,z),Be(fe,()=>a(s),h=>b(s,h)),X("change",fe,z),X("click",qe,w),X("click",ct,l),X("click",Le,C),O(e,N),Xt()}export{wa as component};
